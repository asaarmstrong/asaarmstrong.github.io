!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.htmlMatcher=e():t.htmlMatcher=e()}(this,(()=>(()=>{"use strict";var t={r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e);const n={escape:92,throws:!1};function r(t){return t>47&&t<58}function s(t,e,n){return n=n||90,(t&=-33)>=(e=e||65)&&t<=n}function o(t){return function(t){return 32===t||9===t||160===t}(t)||10===t||13===t}function i(t,e){e=Object.assign(Object.assign({},n),e);const r=t.pos,s=t.peek();if(t.eat(a)){for(;!t.eof();)switch(t.next()){case s:return t.start=r,!0;case e.escape:t.next()}if(t.pos=r,e.throws)throw t.error("Unable to consume quoted string")}return!1}function a(t){return 39===t||34===t}function u(t,e,r,s){s=Object.assign(Object.assign({},n),s);const o=t.pos;if(t.eat(e)){let n,a=1;for(;!t.eof();)if(!i(t,s))if(n=t.next(),n===e)a++;else if(n===r){if(a--,!a)return t.start=o,!0}else n===s.escape&&t.next();if(t.pos=o,s.throws)throw t.error(`Unable to find matching pair for ${String.fromCharCode(e)}`)}return!1}class c{constructor(t,e,n){null==n&&"string"==typeof t&&(n=t.length),this.string=t,this.pos=this.start=e||0,this.end=n||0}eof(){return this.pos>=this.end}limit(t,e){return new c(this.string,t,e)}peek(){return this.string.charCodeAt(this.pos)}next(){if(this.pos<this.string.length)return this.string.charCodeAt(this.pos++)}eat(t){const e=this.peek(),n="function"==typeof t?t(e):e===t;return n&&this.next(),n}eatWhile(t){const e=this.pos;for(;!this.eof()&&this.eat(t););return this.pos!==e}backUp(t){this.pos-=t||1}current(){return this.substring(this.start,this.pos)}substring(t,e){return this.string.slice(t,e)}error(t,e=this.pos){return new f(`${t} at ${e+1}`,e,this.string)}}class f extends Error{constructor(t,e,n){super(t),this.pos=e,this.string=n}}const l={xml:!1,allTokens:!1,special:{style:null,script:["","text/javascript","application/x-javascript","javascript","typescript","ts","coffee","coffeescript"]},empty:["img","meta","link","br","base","hr","area","wbr","col","embed","input","param","source","track"]},p={throws:!1};function h(t={}){return Object.assign(Object.assign({},l),t)}function g(t){return t.split("").map((t=>t.charCodeAt(0)))}function m(t,e){const n=t.pos;for(let r=0;r<e.length;r++)if(!t.eat(e[r]))return t.pos=n,!1;return t.start=n,!0}function d(t,e,n,r){const s=t.pos;if(m(t,e)){for(;!t.eof();){if(m(t,n))return t.start=s,!0;t.pos++}return r?(t.start=s,!0):(t.pos=s,!1)}return t.pos=s,!1}function b(t){return s(t)||58===t||95===t||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=767||t>=880&&t<=893||t>=895&&t<=8191}function y(t){return b(t)||45===t||46===t||r(t)||183===t||t>=768&&t<=879}function k(t){const e=t.pos;return!!t.eat(b)&&(t.eatWhile(y),t.start=e,!0)}function v(t){return 62===t||47===t}function x(t){return!(isNaN(t)||a(t)||o(t)||v(t))}function C(t){return u(t,60,62,p)||u(t,40,41,p)||u(t,91,93,p)||u(t,123,125,p)}function j(t,e){const n=[];let r=0,s=t.length;e&&(r=e.length+1,s-="/>"===t.slice(-2)?2:1);const i=new c(t,r,s);for(;!i.eof();)if(i.eatWhile(o),w(i)){const t={name:i.current(),nameStart:i.start,nameEnd:i.pos};i.eat(61)&&S(i)&&(t.value=i.current(),t.valueStart=i.start,t.valueEnd=i.pos),n.push(t)}else i.pos++;return n}function w(t){const e=t.pos;return t.eat(42)||t.eat(35)?(k(t),t.start=e,!0):C(t)||k(t)}function S(t){return i(t,p)||C(t)||function(t){const e=t.pos;if(t.eatWhile(x))return t.start=e,!0}(t)}const A=g("<![CDATA["),T=g("]]>"),O=g("\x3c!--"),E=g("--\x3e"),W=g("<?"),M=g("?>"),U=g("<%"),$=g("%>");function B(t,e,n){const r=new c(t),s=n?n.special:null,i=!!n&&n.allTokens;let a,u,f,l,p,h=!1,m=null;for(;!r.eof();){const n=r.pos;if(_(r)){if(i&&!1===e("#cdata",4,r.start,r.pos))break}else if(q(r)){if(i&&!1===e("#comment",6,r.start,r.pos))break}else if(I(r)){if(i&&!1===e("#erb",7,r.start,r.pos))break}else if(m=D(r)){if(i&&!1===e(m,5,r.start,r.pos))break}else if(r.eat(60)){if(a=r.eat(47)?2:1,f=r.pos,k(r)&&(l=r.pos,2!==a&&(N(r),r.eatWhile(o),r.eat(47)&&(a=3)),r.eat(62))){if(u=r.substring(f,l),!1===e(u,a,n,r.pos))break;if(1===a&&s&&z(s,u,t,n,r.pos)){for(p=g(u),h=!1;!r.eof();){if(P(r,p)){h=!0;break}r.pos++}if(h&&!1===e(u,2,r.start,r.pos))break}}}else r.pos++}}function N(t){for(;!t.eof();)if(t.eatWhile(o),w(t))t.eat(61)&&S(t);else{if(v(t.peek()))break;t.pos++}}function P(t,e){const n=t.pos;return t.eat(60)&&t.eat(47)&&m(t,e)&&t.eat(62)?(t.start=n,!0):(t.pos=n,!1)}function _(t){return d(t,A,T,!0)}function q(t){return d(t,O,E,!0)}function D(t){const e=t.pos;if(m(t,W)&&k(t)){const n=t.current();for(;!t.eof()&&!m(t,M);)i(t)||t.pos++;return t.start=e,n}return t.pos=e,null}function I(t){const e=t.pos;if(m(t,U)){for(;!t.eof()&&!m(t,$);)i(t)||t.pos++;return t.start=e,!0}return t.pos=e,!1}function z(t,e,n,r,s){if(e in t){const o=t[e];if(!Array.isArray(o))return!0;const i=j(n.substring(r+e.length+1,s-1));return o.includes(function(t,e){for(let r=0;r<t.length;r++){const s=t[r];if(s.name===e)return s.value&&(a((n=s.value).charCodeAt(0))&&(n=n.slice(1)),a(n.charCodeAt(n.length-1))&&(n=n.slice(0,-1)),n)}var n}(i,"type")||"")}return!1}function F(t,e,n,r){if(t.length){const s=t.pop();return s.name=e,s.start=n,s.end=r,s}return{name:e,start:n,end:r}}function G(t,e){t.push(e)}function H(t,e,n,r){const s=j(t.slice(e,n),r);return s.forEach((t=>{t.nameStart+=e,t.nameEnd+=e,null!=t.value&&(t.valueStart+=e,t.valueEnd+=e)})),s}function J(t,e){return!e.xml&&e.empty.includes(t)}function K(t){return t.length?t[t.length-1]:null}const L=function(t,e,n){const r=[],s=[],o=h(n);let i=null;return B(t,((n,a,u,c)=>{if(1===a&&J(n,o)&&(a=3),1===a)s.push(F(r,n,u,c));else if(3===a){if(u<e&&e<c)return i={name:n,attributes:H(t,u,c,n),open:[u,c]},!1}else{const o=K(s);if(o&&o.name===n){if(o.start<e&&e<c)return i={name:n,attributes:H(t,o.start,o.end,n),open:[o.start,o.end],close:[u,c]},!1;s.length&&G(r,s.pop())}}}),o),s.length=r.length=0,i};var Q=j,R=function(t,e,n){const r=[],s=[],o=h(n),i=[],a=(t,e,n)=>{if(r.length){const s=r.pop();return s.name=t,s.ranges.push(e,n),s}return{name:t,ranges:[e,n]}},u=t=>{t.ranges.length=0,t.firstChild=void 0,r.push(t)};return B(t,((t,n,r,c)=>{if(2===n){if(!s.length)return;let n=K(s);if(n.name===t){if(n.ranges[0]<=e&&e<=c){for(i.push({name:t,open:n.ranges.slice(0,2),close:[r,c]});n.firstChild;){const t=n.firstChild,e={name:t.name,open:t.ranges.slice(0,2)};t.ranges.length>2&&(e.close=t.ranges.slice(2,4)),i.push(e),u(n),n=t}return!1}{s.pop();const t=K(s);t&&!t.firstChild?(n.ranges.push(r,c),t.firstChild=n):u(n)}}}else if(3===n||J(t,o)){if(r<e&&e<c)return i.push({name:t,open:[r,c]}),!1;const n=K(s);n&&!n.firstChild&&(n.firstChild=a(t,r,c))}else s.push(a(t,r,c))}),o),s.length=r.length=0,i},V=function(t,e,n){const r=[],s=[],o=h(n),i=[];return B(t,((t,n,a,u)=>{if(2===n){const n=K(s);n&&n.name===t&&(n.start<e&&e<u&&i.push({name:t,open:[n.start,n.end],close:[a,u]}),G(r,s.pop()))}else 3===n||J(t,o)?a<e&&e<u&&i.push({name:t,open:[a,u]}):s.push(F(r,t,a,u))}),o),s.length=r.length=0,i},X=B;return globalThis.emmetMatch=L,globalThis.emmetAttributes=Q,globalThis.emmetBalancedInward=R,globalThis.emmetBalancedOutward=V,globalThis.emmetScan=X,e})()));