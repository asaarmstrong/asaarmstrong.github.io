!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.mathExpression=e():t.mathExpression=e()}(this,(()=>(()=>{"use strict";var t={r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e);function n(t){return t>47&&t<58}function r(t){return 32===t||9===t||160===t}function o(t){return r(t)||10===t||13===t}class s{constructor(t,e,n){null==n&&"string"==typeof t&&(n=t.length),this.string=t,this.pos=this.start=e||0,this.end=n||0}eof(){return this.pos>=this.end}limit(t,e){return new s(this.string,t,e)}peek(){return this.string.charCodeAt(this.pos)}next(){if(this.pos<this.string.length)return this.string.charCodeAt(this.pos++)}eat(t){const e=this.peek(),n="function"==typeof t?t(e):e===t;return n&&this.next(),n}eatWhile(t){const e=this.pos;for(;!this.eof()&&this.eat(t););return this.pos!==e}backUp(t){this.pos-=t||1}current(){return this.substring(this.start,this.pos)}substring(t,e){return this.string.slice(t,e)}error(t,e=this.pos){return new i(`${t} at ${e+1}`,e,this.string)}}class i extends Error{constructor(t,e,n){super(t),this.pos=e,this.string=n}}const p=y("null",0);function u(t){const e=t.pos;return!(!t.eat(46)||!t.eatWhile(n))||(!(!t.eatWhile(n)||t.eat(46)&&!t.eatWhile(n))||(t.pos=e,!1))}function c(t,e){return y("num",parseFloat(t),e)}function h(t,e=0){return 45===t&&(e+=2),y("op1",t,e)}function l(t,e=0){return 42===t?e+=1:47!==t&&92!==t||(e+=2),y("op2",t,e)}function f(t,e){throw e&&(t+=` at column ${e.pos} of expression`),new Error(t)}function a(t){return function(t){return 43===t}(t)||g(t)}function g(t){return 45===t}function d(t){return 43===t||45===t||42===t||47===t||92===t}function y(t,e,n=0){return{type:t,value:e,priority:n}}const x={lookAhead:!0,whitespace:!0};function b(t){if(n(m(t))){t.pos--;let e,r=!1;for(;t.pos>=0;){if(e=m(t),46===e){if(r)break;r=!0}else if(!n(e))break;t.pos--}return!0}return!1}function m(t){return t.text.charCodeAt(t.pos-1)}function w(t){return t.text.charCodeAt(t.pos)}const k={45:t=>-t},v={43:(t,e)=>t+e,45:(t,e)=>t-e,42:(t,e)=>t*e,47:(t,e)=>t/e,92:(t,e)=>Math.floor(t/e)};const E=function(t){if(Array.isArray(t)||(t=function(t){const e="string"==typeof t?new s(t):t;let n,o=0,i=21;const y=[];for(;!e.eof();)e.eatWhile(r),e.start=e.pos,u(e)?(0==(1&i)&&f("Unexpected number",e),y.push(c(e.current())),i=10):d(e.peek())?(n=e.next(),a(n)&&16&i?(g(n)&&y.push(h(n,o)),i=21):(0==(2&i)&&f("Unexpected operator",e),y.push(l(n,o)),i=21)):e.eat(40)?(0==(4&i)&&f('Unexpected "("',e),o+=10,i=53):e.eat(41)?(o-=10,32&i?y.push(p):0==(8&i)&&f('Unexpected ")"',e),i=14):f("Unknown character",e);(o<0||o>=10)&&f('Unmatched "()"',e);const x=function(t){const e=[],n=[];let r=0;for(let o=0;o<t.length;o++){const s=t[o];if("num"===s.type)n.push(s);else{for(r+="op1"===s.type?1:2;e.length&&s.priority<=e[e.length-1].priority;)n.push(e.pop());e.push(s)}}return r+1===n.length+e.length?n.concat(e.reverse()):null}(y);return null===x&&f("Parity",e),x}(t)),!t||!t.length)return null;const e=[];let n,o,i;for(let r=0,s=t.length;r<s;r++){const s=t[r];if("num"===s.type)e.push(s.value);else if("op2"===s.type)o=e.pop(),n=e.pop(),i=v[s.value],e.push(i(n,o));else{if("op1"!==s.type)throw new Error("Invalid expression");n=e.pop(),i=k[s.value],e.push(i(n))}}if(e.length>1)throw new Error("Invalid Expression (parity)");return e[0]};return globalThis.emmetEvaluate=E,globalThis.emmetExtract=function(t,e=t.length,n){const r=Object.assign(Object.assign({},x),n),s={text:t,pos:e};let i;if(r.lookAhead&&41===w(s)){s.pos++;const e=t.length;for(;s.pos<e&&(i=w(s),41===i||r.whitespace&&o(i));)s.pos++}const p=s.pos;let u=0;for(;s.pos>=0;)if(!b(s)){if(i=m(s),41===i)u++;else if(40===i){if(!u)break;u--}else if(!(r.whitespace&&o(i)||a(i)||d(i)))break;s.pos--}if(s.pos!==p&&!u){for(;o(w(s));)s.pos++;return[s.pos,p]}return null},e})()));