!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.cssMatcher=e():t.cssMatcher=e()}(this,(()=>(()=>{"use strict";var t={r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e);function r(t){return function(t){return 32===t||9===t||160===t}(t)||10===t||13===t}function n(t){return 39===t||34===t}class s{constructor(t,e,r){null==r&&"string"==typeof t&&(r=t.length),this.string=t,this.pos=this.start=e||0,this.end=r||0}eof(){return this.pos>=this.end}limit(t,e){return new s(this.string,t,e)}peek(){return this.string.charCodeAt(this.pos)}next(){if(this.pos<this.string.length)return this.string.charCodeAt(this.pos++)}eat(t){const e=this.peek(),r="function"==typeof t?t(e):e===t;return r&&this.next(),r}eatWhile(t){const e=this.pos;for(;!this.eof()&&this.eat(t););return this.pos!==e}backUp(t){this.pos-=t||1}current(){return this.substring(this.start,this.pos)}substring(t,e){return this.string.slice(t,e)}error(t,e=this.pos){return new o(`${t} at ${e+1}`,e,this.string)}}class o extends Error{constructor(t,e,r){super(t),this.pos=e,this.string=r}}function i(t,e){const r=new s(t),n={start:-1,end:-1,propertyStart:-1,propertyEnd:-1,propertyDelimiter:-1,expression:0};let o;const i=(t,s=r.start,o=n.start,i=n.end)=>!1===e(t,o,i,s);for(;!r.eof();)if(!l(r)&&!p(r))if(r.start=r.pos,(o=r.eat(125))||r.eat(59)){if(-1!==n.propertyStart){if(i("propertyName",n.propertyDelimiter,n.propertyStart,n.propertyEnd))return;if(-1===n.start&&(n.start=n.end=r.start),i("propertyValue"))return}else if(-1!==n.start&&i("propertyName"))return;if(o&&(n.start=r.start,n.end=r.pos,i("blockEnd")))return;u(n)}else if(r.eat(123)){if(-1===n.start&&-1===n.propertyStart&&(n.start=n.end=r.pos),-1!==n.propertyStart&&(n.start=n.propertyStart),i("selector"))return;u(n)}else r.eat(58)&&!f(r,n)?(-1===n.propertyStart&&(n.propertyStart=n.start),n.propertyEnd=n.end,n.propertyDelimiter=r.pos-1,n.start=n.end=-1):(-1===n.start&&(n.start=r.pos),r.eat(40)?n.expression++:r.eat(41)?n.expression--:a(r)||r.pos++,n.end=r.pos);-1!==n.propertyStart&&i("propertyName",n.propertyDelimiter,n.propertyStart,n.propertyEnd)||-1!==n.start&&i(-1!==n.propertyStart?"propertyValue":"propertyName",-1)}function p(t){return t.eatWhile(r)}function l(t){const e=t.pos;if(t.eat(47)&&t.eat(42)){for(t.start=e;!t.eof();)if(t.eat(42)){if(t.eat(47))return!0}else t.pos++;return!0}return t.pos=e,!1}function a(t){const e=t.peek();if(n(e)){for(t.start=t.pos++;!t.eof()&&!(t.eat(e)||t.eat(10)||t.eat(13));)t.eat(92),t.pos++;return!0}}function u(t){t.start=t.end=t.propertyStart=t.propertyEnd=t.propertyDelimiter=-1}function f(t,e){return e.expression||t.eatWhile(58)}const c=[43,47,42,44];function h(t){return c.includes(t)}function d(t){const e=t.pos;return!(!t.eat(45)||!t.eat(r))||(t.pos=e,!1)}function y(t,e,n){for(;e<n&&r(t.charCodeAt(e));)e++;for(;n>e&&r(t.charCodeAt(n-1));)n--;return e!==n?[e,n]:null}function m(t,e,r,n){if(t.length){const s=t.pop();return s[0]=e,s[1]=r,s[2]=n,s}return[e,r,n]}function g(t,e){return e&&t.push(e),null}function b(t,e){const r=t.length?t[t.length-1]:null;r&&r[0]===e[0]&&r[1]===e[1]||e[0]===e[1]||t.push(e)}function S(t){return t.length?t[t.length-1]:null}const C=function(t,e){const r=[],n=[];let s=null,o=null;const p=()=>{o&&(g(r,o),o=null)};return i(t,((t,i,l,a)=>{if("selector"===t)p(),n.push(m(r,i,l,a));else if("blockEnd"===t){p();const t=n.pop();if(t&&t[0]<e&&e<l)return s={type:"selector",start:t[0],end:l,bodyStart:t[2]+1,bodyEnd:i},!1}else if("propertyName"===t)p(),o=m(r,i,l,a);else if("propertyValue"===t){if(o&&o[0]<e&&e<l)return s={type:"property",start:o[0],end:a+1,bodyStart:i,bodyEnd:l},!1;p()}})),s};var x=function(t,e){const r=[],n=[],s=[];let o=null;const p=(t,e,n)=>{if(r.length){const s=r.pop();return s.start=t,s.end=e,s.delimiter=n,s}return{start:t,end:e,delimiter:n,firstChild:null}},l=t=>{t.firstChild=null,r.push(t)},a=()=>{o&&(l(o),o=null)};return i(t,((r,i,u,f)=>{if("blockEnd"===r){a();let r=n.pop();if(!r)return;if(r.start<=e&&e<=u){let e=y(t,r.delimiter+1,i);for(b(s,[r.start,u]),e&&b(s,e);r.firstChild;){const n=r.firstChild;e=y(t,n.delimiter+1,n.end-1),b(s,[n.start,n.end]),e&&b(s,e),r=n}return!1}{const t=S(n);t&&!t.firstChild?(r.end=u,t.firstChild=r):l(r)}}else if("propertyName"===r)a(),o=p(i,u,f),((t,e,r)=>{const s=S(n);s&&!s.firstChild&&(s.firstChild=p(t,e,r))})(i,u,f);else if("propertyValue"===r){if(o){if(o.start<=e&&u>=e)return b(s,[o.start,f+1]),b(s,[i,u]),a(),!1;const t=S(n);t&&t.firstChild&&t.firstChild.start===o.start&&(t.firstChild.end=-1!==f?f+1:u),a()}}else n.push(p(i,u,f)),a()})),n.length=r.length=0,s},E=function(t,e){const r=[],n=[],s=[];let o=null;return i(t,((i,p,l,a)=>{if("selector"===i)n.push(m(r,p,l,a));else if("blockEnd"===i){const o=n.pop();if(o&&o[0]<e&&l>e){const e=y(t,o[2]+1,p);e&&b(s,e),b(s,[o[0],l])}if(o&&g(r,o),!n.length)return!1}else"propertyName"===i?(o&&g(r,o),o=m(r,p,l,a)):"propertyValue"===i&&o&&o[0]<e&&Math.max(a,l)>e&&(b(s,[p,l]),b(s,[o[0],-1!==a?a+1:l]));"propertyName"!==i&&o&&(g(r,o),o=null)})),s},k=i,N=function(t,e=0){let n=-1,o=0,i=0;const p=[],l=new s(t);for(;!l.eof();)i=l.pos,l.eat(r)||l.eat(h)||d(l)?(o||-1===n||(p.push([e+n,e+i]),n=-1),l.eatWhile(r)):(-1===n&&(n=l.pos),l.eat(40)?o++:l.eat(41)?o--:a(l)||l.pos++);return-1!==n&&n!==l.pos&&p.push([e+n,e+l.pos]),p};return globalThis.emmetMatch=C,globalThis.emmetBalancedInward=x,globalThis.emmetBalancedOutward=E,globalThis.emmetScan=k,globalThis.emmetSplitValue=N,e})()));